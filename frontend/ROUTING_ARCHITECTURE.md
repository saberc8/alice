# 路由架构说明

## 当前状态

这个项目目前使用了**混合路由架构**：

### 1. 静态路由 (`/src/routes/sections/dashboard/index.tsx`)
- 在应用启动时定义的固定路由
- 用于确保所有页面都有对应的路由配置
- 包含所有系统页面的路由定义

### 2. 动态路由 (`/src/routes/sections/dashboard/backend.tsx`)
- 从后端菜单数据动态生成路由
- 使用 `useBackendDashboardRoutes` hook 获取
- 基于用户权限和菜单配置

### 3. 动态导航 (`/src/layouts/dashboard/nav/`)
- 导航菜单完全由后端数据驱动
- 使用 `useBackendNavData` 从菜单树生成导航
- 支持权限过滤和动态显示

## 路由关系

```
后端菜单数据 (tree.md)
    ↓
userStore.userMenuTree
    ↓
useBackendNavData() → 生成导航菜单
    ↓
useBackendDashboardRoutes() → 生成动态路由（当前未使用）
```

## 问题分析

你提到的问题很正确：**既然后端已经下发了菜单数据，为什么还需要维护前端静态路由？**

原因：
1. **React Router 限制**: 静态路由配置在应用启动时就需要完整定义
2. **数据异步加载**: 后端菜单数据需要异步获取，在路由初始化时可能还未加载
3. **兼容性考虑**: 确保所有页面都有路由可访问，即使后端数据出现问题

## 解决方案

### 方案1: 完全动态路由（推荐）
移除静态路由，完全使用后端数据生成路由：
- 优点: 单一数据源，完全动态
- 缺点: 需要重构路由系统，处理异步加载

### 方案2: 当前混合方案（已采用）
保持静态路由作为基础，后端数据用于导航和权限控制：
- 优点: 稳定可靠，兼容性好
- 缺点: 需要维护两套配置

## 最佳实践建议

1. **保持静态路由**: 确保页面文件存在且路由配置正确
2. **后端控制显示**: 使用后端菜单数据控制导航显示和权限
3. **逐步迁移**: 可以逐步将更多逻辑迁移到动态系统

## 文件对应关系

- 静态路由: `/routes/sections/dashboard/index.tsx`
- 动态路由: `/routes/sections/dashboard/backend.tsx`
- 页面文件: `/pages/` 目录下对应的组件
- 导航数据: `/layouts/dashboard/nav/` 目录

## 注意事项

1. 确保所有路由都有对应的页面文件
2. 页面文件需要正确导出 `Component` 用于懒加载
3. 后端菜单数据的 `path` 字段需要与前端路由匹配
4. 权限控制主要在导航层面实现，路由层面作为备份
